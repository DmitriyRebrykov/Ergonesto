{%extends 'main/base.html'%}
{%load static%}

{%block title%}{{title}}{%endblock title%}

{%block link%}<link type="text/css" href="{% static 'main/css/catalog.css' %}" rel="stylesheet">{%endblock link%}

{%block content%}
    <!-- Main Content -->
    <main class="catalog-page">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Каталог товарів</h1>
                <p class="page-description">Ергономічні рішення для комфортної роботи в офісі</p>
            </div>

            <!-- Catalog Controls -->
            <div class="catalog-controls">
                <!-- Mobile Filter Toggle -->
                <button class="mobile-filter-toggle" type="button" aria-label="Відкрити фільтри" data-filter-toggle>
                    <i class="fas fa-filter"></i>
                    <span>Фільтри</span>
                    <span class="filter-count" id="active-filters-count">0</span>
                </button>

                <!-- View Toggle -->
                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid" aria-label="Сітка товарів">
                        <i class="fas fa-th"></i>
                    </button>
                    <button class="view-btn" data-view="list" aria-label="Список товарів">
                        <i class="fas fa-list"></i>
                    </button>
                </div>

                <!-- Sort Controls -->
                <div class="sort-controls">
                    <label for="sort-select" class="sort-label">Сортувати:</label>
                    <select id="sort-select" class="sort-select">
                        <option value="popularity">За популярністю</option>
                        <option value="price-asc">Ціна: від низької до високої</option>
                        <option value="price-desc">Ціна: від високої до низької</option>
                        <option value="name-asc">Назва: А-Я</option>
                        <option value="name-desc">Назва: Я-А</option>
                        <option value="rating">За рейтингом</option>
                        <option value="newest">Найновіші</option>
                    </select>
                </div>

                <!-- Results Info -->
                <div class="results-info">
                    <span class="results-count">Знайдено: <strong id="results-count">24</strong> товари</span>
                </div>
            </div>

            <!-- Catalog Layout -->
            <div class="catalog-layout">
                <!-- Sidebar with Filters -->
                <aside class="catalog-sidebar" id="catalog-sidebar" aria-label="Фільтри товарів">
                    <div class="sidebar-header">
                        <h2 class="sidebar-title">Фільтри</h2>
                        <button class="clear-filters-btn" type="button" id="clear-filters">
                            <i class="fas fa-times"></i>
                            Очистити все
                        </button>
                    </div>

                    <!-- Search Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Пошук</h3>
                        <div class="search-filter">
                            <input type="text" id="search-input" class="search-input" placeholder="Пошук товарів...">
                            <button class="search-btn" type="button" aria-label="Пошук">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Category Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Категорії</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="category" value="footrests" data-filter="category">
                                <span class="checkmark"></span>
                                <span class="option-text">Підставки для ніг</span>
                                <span class="option-count">(8)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="category" value="back-support" data-filter="category">
                                <span class="checkmark"></span>
                                <span class="option-text">Підтримка спини</span>
                                <span class="option-count">(6)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="category" value="organizers" data-filter="category">
                                <span class="checkmark"></span>
                                <span class="option-text">Органайзери</span>
                                <span class="option-count">(5)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="category" value="lighting" data-filter="category">
                                <span class="checkmark"></span>
                                <span class="option-text">Освітлення</span>
                                <span class="option-count">(3)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="category" value="accessories" data-filter="category">
                                <span class="checkmark"></span>
                                <span class="option-text">Аксесуари</span>
                                <span class="option-count">(2)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Price Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Ціна</h3>
                        <div class="price-filter">
                            <div class="price-range">
                                <input type="range" id="price-min" class="price-slider" min="0" max="5000" value="0" data-filter="price-min">
                                <input type="range" id="price-max" class="price-slider" min="0" max="5000" value="5000" data-filter="price-max">
                            </div>
                            <div class="price-inputs">
                                <div class="price-input-group">
                                    <label for="price-from">Від:</label>
                                    <input type="number" id="price-from" class="price-input" min="0" max="5000" value="0">
                                    <span class="currency">₴</span>
                                </div>
                                <div class="price-input-group">
                                    <label for="price-to">До:</label>
                                    <input type="number" id="price-to" class="price-input" min="0" max="5000" value="5000">
                                    <span class="currency">₴</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Material Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Матеріал</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="material" value="wood" data-filter="material">
                                <span class="checkmark"></span>
                                <span class="option-text">Дерево</span>
                                <span class="option-count">(12)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="material" value="metal" data-filter="material">
                                <span class="checkmark"></span>
                                <span class="option-text">Метал</span>
                                <span class="option-count">(8)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="material" value="plastic" data-filter="material">
                                <span class="checkmark"></span>
                                <span class="option-text">Пластик</span>
                                <span class="option-count">(4)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Color Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Колір</h3>
                        <div class="color-filter">
                            <label class="color-option" title="Коричневий">
                                <input type="checkbox" name="color" value="brown" data-filter="color">
                                <span class="color-swatch" style="background-color: #8B4513;"></span>
                            </label>
                            <label class="color-option" title="Чорний">
                                <input type="checkbox" name="color" value="black" data-filter="color">
                                <span class="color-swatch" style="background-color: #2C2C2C;"></span>
                            </label>
                            <label class="color-option" title="Білий">
                                <input type="checkbox" name="color" value="white" data-filter="color">
                                <span class="color-swatch" style="background-color: #FFFFFF;"></span>
                            </label>
                            <label class="color-option" title="Сірий">
                                <input type="checkbox" name="color" value="gray" data-filter="color">
                                <span class="color-swatch" style="background-color: #808080;"></span>
                            </label>
                            <label class="color-option" title="Бежевий">
                                <input type="checkbox" name="color" value="beige" data-filter="color">
                                <span class="color-swatch" style="background-color: #F5F5DC;"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Rating Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Рейтинг</h3>
                        <div class="rating-filter">
                            <label class="rating-option">
                                <input type="radio" name="rating" value="5" data-filter="rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                </div>
                                <span class="rating-text">5 зірок</span>
                            </label>
                            <label class="rating-option">
                                <input type="radio" name="rating" value="4" data-filter="rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                                <span class="rating-text">4+ зірок</span>
                            </label>
                            <label class="rating-option">
                                <input type="radio" name="rating" value="3" data-filter="rating">
                                <div class="rating-stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                                <span class="rating-text">3+ зірок</span>
                            </label>
                        </div>
                    </div>

                    <!-- Availability Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Наявність</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="availability" value="in-stock" data-filter="availability">
                                <span class="checkmark"></span>
                                <span class="option-text">В наявності</span>
                                <span class="option-count">(20)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="availability" value="pre-order" data-filter="availability">
                                <span class="checkmark"></span>
                                <span class="option-text">Під замовлення</span>
                                <span class="option-count">(4)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Features Filter -->
                    <div class="filter-group">
                        <h3 class="filter-title">Особливості</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="checkbox" name="features" value="adjustable" data-filter="features">
                                <span class="checkmark"></span>
                                <span class="option-text">Регульований</span>
                                <span class="option-count">(15)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="features" value="eco-friendly" data-filter="features">
                                <span class="checkmark"></span>
                                <span class="option-text">Екологічний</span>
                                <span class="option-count">(10)</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="features" value="warranty" data-filter="features">
                                <span class="checkmark"></span>
                                <span class="option-text">Гарантія 2+ роки</span>
                                <span class="option-count">(18)</span>
                            </label>
                        </div>
                    </div>
                </aside>

                <!-- Products Grid -->
                <!-- Products Container -->
<div class="catalog-content">
    <!-- Active Filters -->
    <div class="active-filters" id="active-filters" style="display: none;">
        <div class="active-filters-header">
            <span class="active-filters-title">Активні фільтри:</span>
            <button class="clear-all-filters" type="button">Очистити все</button>
        </div>
        <div class="active-filters-list" id="active-filters-list">
            <!-- Active filter tags will be inserted here -->
        </div>
    </div>

    <!-- Products Container -->
    <div class="products-container" id="products-container">
        <div class="products-grid" id="products-grid">
            {%for product in products%}
            <div class="product-card" data-category="footrests" data-price="2499" data-rating="4.9" data-features="adjustable,eco-friendly,warranty" data-availability="in-stock">
                <div class="product-image">
                    <img src="{{product.product.main_image.url}}" alt="ERGONESTO Ергономічна підставка для ніг">
                    <div class="product-badges">
                        <span class="product-badge badge-sale">Знижка</span>
                        <span class="product-badge badge-bestseller">Аб. продажів</span>
                    </div>
                    <div class="product-actions">
                        <button class="product-action-btn" aria-label="Додати в обране">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="product-action-btn" aria-label="Швидкий перегляд">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="product-info">
                    <div class="product-category">{{product.sku}}</div>
                    <h3 class="product-title">
                        <a href="{%url 'main:detail_page' product.id %}">{{product.product.name}}</a>
                    </h3>
                    <div class="product-rating">
                        <div class="product-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <span class="product-rating-text">49 (2500)</span>
                    </div>
                    <div class="product-features">
                        <div class="product-features-list">
                            <span class="product-feature">Регульований</span>
                            <span class="product-feature">Екологічний</span>
                            <span class="product-feature">Гарантія</span>
                        </div>
                    </div>
                    <div class="product-availability">
                        <span class="availability-text in-stock">✓ В наявності ({{product.inventory}} шт.)</span>
                    </div>
                    <div class="product-price">
                        <span class="current-price">{{product.price}} ₴</span>
<!--                        <span class="old-price">3 199 ₴</span>-->
<!--                        <span class="discount-percent">22%</span>-->
                    </div>
                    <div class="product-card-actions">
                        <button class="add-to-cart-btn">В кошик</button>
                        <button class="quick-view-btn">
                            <i class="far fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
            {%endfor%}
            <!-- Product Card 1 -->

        </div>

        <!-- Loading State -->
        <div class="loading-state" id="loading-state" style="display: none;">
            <div class="loading-spinner"></div>
            <p>Завантаження товарів...</p>
        </div>

        <!-- No Results State -->
        <div class="no-results" id="no-results" style="display: none;">
            <div class="no-results-icon">
                <i class="fas fa-search"></i>
            </div>
            <h3>Товари не знайдено</h3>
            <p>Спробуйте змінити параметри фільтрації або очистити всі фільтри</p>
            <button class="btn btn-primary" id="clear-filters-mobile">Очистити фільтри</button>
        </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" id="pagination-container">
        <nav class="pagination" aria-label="Навігація по сторінках">
            <button class="pagination-btn prev" type="button" aria-label="Попередня сторінка" disabled>
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="pagination-pages">
                <button class="pagination-page active" data-page="1">1</button>
                <button class="pagination-page" data-page="2">2</button>
                <button class="pagination-page" data-page="3">3</button>
            </div>
            <button class="pagination-btn next" type="button" aria-label="Наступна сторінка">
                <i class="fas fa-chevron-right"></i>
            </button>
        </nav>
        <div class="pagination-info">
            <span>Сторінка 1 з 3 (24 товари)</span>
        </div>
    </div>
</div>
            </div>
        </div>
    </main>
<script src="{%static 'main/js/catalog.js'%}"></script>
{%endblock%}